
                                  ┏━━━━━━━━━━━━━━━━┓
                                  ┃   AWS_CONFIG   ┃
                                  ┗━━━━━━━━━━━━━━━━┛

GOAL ==>                          #Common config for all AWS clients, except REST API

                                  ┌──────────┐
                                  │   MAIN   │
                                  └──────────┘

CONFIGURATION ==>                 #Can be (in priority):
                                  #  - CLIENT-specific flags (CLI flags, programmatic options, etc.)
                                  #  - ENVVAR
                                  #  - CONFIG
                                  #  - CREDS
                                  #  - ENVVAR AWS_CONFIG_FILE|AWS_SHARED_CREDENTIALS_FILE 'PATH'

CONFIG                            #~/.aws/config INI file
                                  #Top-level keys: 'default' or 'profile PROFILE'
                                  #Values: OBJ
[VAR1]
VAR2 =
  ...                             #Nesting in INI file

                                  ┌────────────────┐
                                  │   CONFIG CLI   │
                                  └────────────────┘

aws configure list
aws configure get [PROFILE.]VAR
aws configure set
 [PROFILE.]VAR VAL                #Get|set CONFIG|CREDS

aws configure                     #Create CONFIG|CREDS interactively

                                  ┌─────────────┐
                                  │   PROFILE   │
                                  └─────────────┘

CONFIG.profile                    #Pick top-level key in CONFIG|CREDS
ENVVAR AWS_PROFILE                #Similar purpose as ROLEs, i.e. different credentials|configs
ENVVAR AWS_DEFAULT_PROFILE        #Default value for CONFIG.profile
                                  #Def: 'default'

                                  ┌─────────────────┐
                                  │   PROFILE CLI   │
                                  └─────────────────┘

--profile                         #CONFIG.profile

aws configure list-profiles       #Print all PROFILEs

aws configure import              #Set multiple PROFILEs using a CSV file with columns: 'PROFILE', ACCESS_KEY_ID, SECRET_ACCESS_KEY
                                  #That CSV file can be downloaded from UI
--csv                             #'PATH'
--profile-prefix                  #STR to prepend to all 'PROFILE'
--skip-invalid                    #BOOL (def: false). Do not fail if invalid

                                  ┌─────────────────┐
                                  │   PROFILE SDK   │
                                  └─────────────────┘

OPTS.profile                      #'PROFILE', with fromInit|fromProcess()

                                  ┌──────────────┐
                                  │   DEFAULTS   │
                                  └──────────────┘

CONFIG.defaults_mode              #Meant to set multiple default values for CONFIG.*
ENVVAR AWS_DEFAULTS_MODE          #Can be:
                                  #  - 'legacy' (def)
                                  #  - 'standard': recommended if sometimes single REGION, sometimes multiple
                                  #  - 'in-region': recommended if single REGION
                                  #  - 'cross-region': recommended if multiple REGIONs
                                  #  - 'mobile': recommended if mobile app
                                  #  - 'auto':
                                  #     - guesses best value among above
                                  #     - that guess can be slow
                                  #Which CONFIG.* default is changed is documented separately

                                  ┌──────────┐
                                  │   AUTH   │
                                  └──────────┘

CREDS                             #~/.aws/credentials
                                  #Same format as ~/.aws/config
                                  #But with config keys meant to be confidential
                                  #Top-level keys: 'default' or 'PROFILE'

CONFIG|CREDS.aws_access_key_id
ENVVAR AWS_ACCESS_KEY_ID          #ACCESS_KEY_ID
CONFIG|CREDS.aws_secret_access_key
ENVVAR AWS_SECRET_ACCESS_KEY      #SECRET_ACCESS_KEY
CONFIG|CREDS.aws_session_token
ENVVAR AWS_SESSION_TOKEN          #SESSION_TOKEN
CONFIG|CREDS.aws_credential_scope
ENVVAR AWS_CREDENTIAL_SCOPE       #See TEMP_CREDS.CredentialScope in STS doc
CONFIG|CREDS.aws_account_id
ENVVAR AWS_ACCOUNT_ID             #'ACCOUNT_ID'

aws-vault                         #CLI tool to encrypt CREDS using an encrypted file, OS-specific keychain, pass, Yubikey
                                  #Login through temporary created ROLEs
                                  #Can also manage multiple profiles, or rotate CREDS
                                  #Not documented yet

                                  ┌──────────────┐
                                  │   AUTH CLI   │
                                  └──────────────┘

aws configure export-credentials  #Print current CREDENTIALS_OBJ
--format                          #Can be:
                                  #  - 'process' (def): JSON
                                  #  - 'env': `export AWS_...=...`
                                  #  - 'env-no-export': `AWS_...=...`
                                  #  - 'powershell': `$Env:AWS_...="..."`
                                  #  - 'windows-cmd': `set AWS_...=...`

CREDENTIALS_OBJ                   #
CREDENTIALS_OBJ.Version           #'1'
CREDENTIALS_OBJ.AccessKeyId       #STR
CREDENTIALS_OBJ.SecretAccessKey   #STR
CREDENTIALS_OBJ.SessionToken      #STR
CREDENTIALS_OBJ.CredentialScope   #STR
CREDENTIALS_OBJ.AccountId         #STR
CREDENTIALS_OBJ.Expiration        #'DATE' (def: none)

                                  ┌──────────┐
                                  │   ROLE   │
                                  └──────────┘

CONFIG.role_arn
ENVVAR AWS_ROLE_ARN               #'ROLE'. Use STS AssumeRole()

CONFIG.source_profile             #'PROFILE' for a CONFIG to load, when using CONFIG.role_arn
CONFIG.credential_source          #PROFILE for a CREDS to load, when using CONFIG.role_arn
                                  #Can be:
                                  #  - 'Environment': use ENVVAR AWS_*
                                  #  - 'Ec2InstanceMetadata':
                                  #      - inside an EC2 container, use instance metadata
                                  #      - only needed when switching to another ROLE than EC2 container's one
                                  #  - 'EcsContainer': same for ECS

CONFIG.role_session_name
ENVVAR AWS_ROLE_SESSION_NAME
CONFIG.duration_seconds
CONFIG.external_id                #Like STS ASSUME_ROLE_REQ.*
CONFIG.mfa_serial                 #Like STS ASSUME_ROLE_REQ.SerialNumber

CONFIG.web_identity_token_file    #'PATH' to WEB_ID_ROLE_REQ.WebIdentityToken.
ENVVAR AWS_WEB_IDENTITY_TOKEN_FILE#Use STS AssumeRoleWithWebIdentity() instead.

                                  ┌─────────┐
                                  │   SSO   │
                                  └─────────┘

CONFIG.sso_*                      #IAM identity center config
CONFIG.sso_account_id             #ACCOUNT_ID
CONFIG.sso_role_name              #'ROLE'

CONFIG.sso_session                #'SSO_PROFILE'
[sso-session SSO_PROFILE]         #Top-level key: like PROFILE but for SSO_CONFIG
SSO_CONFIG.sso_region             #"REGION"
SSO_CONFIG.sso_start_url          #URL
SSO_CONFIG.sso_registration_scopes#"sso:account:..."

                                  ┌─────────────┐
                                  │   SSO CLI   │
                                  └─────────────┘

aws configure sso                 #Like `aws configure ...` but for CONFIG.sso_*
--no-browser                      #Do not open browser automatically

aws configure sso-session         #Like `aws configure ...` but for SSO_CONFIG.*

                                  ┌────────────────────────┐
                                  │   CREDENTIAL PROCESS   │
                                  └────────────────────────┘

CONFIG.credential_process         #'PROGRAM [--FLAGS...]' to get credentials from.
                                  #Must print on stdout a CREDENTIALS_OBJ (see above) as JSON

                                  ┌────────────┐
                                  │   OTHERS   │
                                  └────────────┘

CONFIG.tcp_keepalive              #BOOL (def: false)
