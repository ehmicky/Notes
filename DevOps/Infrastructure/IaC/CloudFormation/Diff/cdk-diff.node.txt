
            
   CDK-DIFF  
            



VERSION ==>                       #Part of cdk monorepo (see its doc)

diffTemplate
 (TEMPLATE_OBJ, TEMPLATE_OBJ2)
 ->DTEMPLATE                      #Compute differences between two CloudFormation TEMPLATEs

DTEMPLATE.awsTemplateFormatVersion
 |description|transform           #DVAL. undefined if no difference

DTEMPLATE.metadata|parameters
 |mappings|conditions|outputs     #DOBJ
DTEMPLATE.unknown                 #DOBJ for unknown TEMPLATE_OBJ.* properties
DOBJ.changes.PROP                 #DVAL. undefined if no difference
DOBJ.get('PROP')->DVAL            #Same but throws if no difference
DOBJ.logicalIds                   #'PROP'_ARR with differences
DOBJ.differenceCount              #NUM of different PROPs
DOBJ.forEachDifference            #Call FUNC() on each different PROP
 (FUNC('PROP', DVAL))             #Ordered: isRemoval true, isAddition true, isUpdate true, isDifferent true
DOBJ.filter
 (FUNC([DVAL])->BOOL)
 ->DOBJ2                          #Omit PROP if BOOL false

DTEMPLATE.resources               #DRESOURCES
DRESOURCES
 .changes|get|logicalIds|filter   #Like DOBJ.* but using DRESOURCE instead of DVAL
DRESOURCE                         #Differences in TEMPLATE.Resources.RESOURCE
                                  #Inherits DVAL
DRESOURCE.old|newResourceType     #'RESTYPE'. undefined if new|deleted RESOURCE
DRESOURCE.resourceType            #newResourceType || oldResourceType. Throws unless new|deleted RESOURCE
DRESOURCE.resourceTypeChanged     #BOOL. Whether 'RESTYPE' changed. false if new|deleted RESOURCE
DRESOURCE.changeImpact            #ENUM ResourceImpact among:
                                  #  - 'WILL_CREATE': new RESOURCE
                                  #  - 'WILL_DESTROY': deleted RESOURCE
                                  #  - 'WILL_ORPHAN': deleted RESOURCE with DeletionPolicy 'Retain'
                                  #  - 'WILL_REPLACE': replacement
                                  #  - 'MAY_REPLACE': potential replacement
                                  #  - 'WILL_UPDATE': no replacement
                                  #  - 'NO_CHANGE': no diff
                                  #Uses CloudFormation spec to know
DRESOURCE.otherChanges.PROP       #DVAL. TEMPLATE.Resources.RESOURCE.PROP undefined if no difference
                                  #Not for PROP `Properties`
DRESOURCE.differenceCount         #NUM of different PROPs|RESPROPs
RES.forEachDifference
 (FUNC('Property|Other',          #Call FUNC() on each different PROP|RESPROP
 'PROP|RESPROP', DVAL))           #Alphabetical order

DRESOURCE.old|newProperties       #RESPROPS_OBJ. undefined if new|deleted RESOURCE
DRESOURCE.propertyUpdates.RESPROP #DRESPROP. undefined if no difference
DRESOURCE.setPropertyChange
 ('RESPROP', DRESPROP)            #
DRESPROP                          #Differences in TEMPLATE.Resources.RESOURCE.Properties.RESPROP
                                  #Inherits DVAL
DRESPROP.changeImpact             #Same as DRESOURCE.changeImpact, but only for a RESPROP, not a RESOURCE
                                  #No 'WILL_CREATE', 'WILL_DESTROY', 'WILL_ORPHAN'

DVAL.oldValue|newValue            #VAL from TEMPLATE_OBJ[2]
DVAL.isDifferent                  #BOOL. False when different syntax, but same semantics (e.g. null <=> undefined)
DVAL.isAddition|isRemoval|isUpdate#BOOL. Depending on whether oldValue|newValue undefined

DTEMPLATE.iamChanges              #DIAM
Each DRESOURCE: if changed RESOURCE, not 'RESTYPE' update, not deleted RESOURCE

EgressRules: EC2 SECURITY_GROUP.SecurityGroupEgress
IngressRules: EC2 SECURITY_GROUP.SecurityGroupIngress
ManagedPolicies: IAM USER|GROUP|ROLE.ManagedPolicyArns
InlineIdentityPolicies: IAM USER|GROUP|ROLE.Policies
None: SNS SUBSCRIPTION.DeliveryPolicy|FilterPolicy, SQS QUEUE.RedrivePolicy
InlineResourcePolicy: Resource-level IAM POLICY, e.g. IAM ROLE.AssumeRolePolicyDocument, Lambda FUNC.Policy, ApiGateway API.Policy, etc.
