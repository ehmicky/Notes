
                                  ┏━━━━━━━━━━━━┓
                                  ┃   HELMET   ┃
                                  ┗━━━━━━━━━━━━┛

VERSION ==>                       #8.0.0

helmet-csp                        #
HELPER_CSP([OPTS])->EXPRESS_MDWR  #Sets Content-Security-Policy [S]
OPTS.reportOnly                   #BOOL (def: false). Content-Security-Policy-Report-Only [S] instead of Content-Security-Policy [S]
OPTS.directives                   #{CSP_TYPE: 'TVAL'[(REQ, RES)][_ARR]|null,...} (def: getDefaultDirectives())
                                  #If CSP_TYPE is camelCase, dash-erized
dangerouslyDisableDefaultSrc      #To use instead of null when CSP_TYPE is 'default-src'
OPTS.useDefaults                  #BOOL (def: true). Merges getDefaultDirectives() with lower priority
getDefaultDirectives()->OBJ       #{CSP_TYPE: 'TVAL'_ARR} with
                                  #  - CSP_TYPE default-src ["'self'"]
                                  #  - CSP_TYPE script-src ["'self'"]
                                  #  - CSP_TYPE script-src-attr ["'none'"]
                                  #  - CSP_TYPE style-src ["'self'", "https:", "'unsafe-inline'"]
                                  #  - CSP_TYPE font-src ["'self'", "https:", "data:"]
                                  #  - CSP_TYPE img-src ["'self'", "data:"]
                                  #  - CSP_TYPE object-src ["'none'"]
                                  #  - CSP_TYPE base-uri|form-action|frame-ancestors ["'self'"]
                                  #  - CSP_TYPE upgrade-insecure-requests []

crossOriginEmbedderPolicy([OPTS])
 ->EXPRESS_MIDWR                  #Sets Cross-Origin-Embedder-Policy [S]
OPTS.policy                       #STR (def: 'require-corp')

crossOriginOpenerPolicy([OPTS])
 ->EXPRESS_MIDWR                  #Sets Cross-Origin-Opener-Policy [S]
OPTS.policy                       #STR (def: 'same-origin')

cross-origin-resource-policy      #
CROSS-ORIGIN-RESOURCE-POLICY
 ([OPTS])->EXPRESS_MIDWR          #Sets Cross-Origin-Resource-Policy [S]
OPTS.policy                       #STR (def: 'same-origin')

originAgentCluster()
 ->EXPRESS_MIDWR                  #Sets Origin-Agent-Cluster: ?1 [S]

referrer-policy                   #
REFERRER-POLICY([OPTS])
 ->EXPRESS_MIDWR                  #Sets Referrer-Policy [S]
OPTS.policy                       #STR[_ARR] (def: 'no-referrer')

hsts                              #
HSTS([OPTS])->EXPRESS_MIDWR       #Sets Strict-Transport-Security [S]
OPTS.maxAge                       #NUM (in secs, def: 1 year)
OPTS.includeSubDomains            #BOOL (def: true)
OPTS.preload                      #BOOL (def: false)

dont-sniff-mimetype               #
DONT-SNIFF-MIMETYPE()
 ->EXPRESS_MIDWR                  #Sets X-Content-Type-Options: nosniff [S]

dns-prefetch-control              #
DNS-PREFETCH-CONTROL([OPTS])      #
 ->EXPRESS_MIDWR                  #Sets X-DNS-Prefetch-Control [S]
OPTS.allow                        #BOOL (def: false)

ienoopen                          #
IENOOPEN()->EXPRESS_MIDWR         #Sets X-Download-Options: noopen [S]

frameguard                        #
FRAMEGUARD([OPTS])->EXPRESS_MIDWR #Sets X-Frame-Options [S]
OPTS.action                       #STR (def: 'sameorigin')

helmet-crossdomain                #
HELMET-CROSSDOMAIN([OPTS])
 ->EXPRESS_MIDWR                  #Sets X-Permitted-Cross-Domain-Policies [S]
OPTS.permittedPolicies            #STR (def: 'none')

hide-powered-by                   #
HIDE-POWERED-BY()->EXPRESS_MIDWR  #Unsets X-Powered-By [S]

x-xss-protection                  #
X-XSS-PROTECTION()->EXPRESS_MIDWR #Sets X-XSS-Protection: 0 [S]

TODO: top-level index.js
TODO: look at the READMEs
TODO: compare with Middy






HELMET([OBJ])                     #Security express MIDWR (0.4.0) package that includes several HELMET.FEATURE(...) MIDWR
                                  #Using HELMET() directly include all of them (unless using OBJ.FEATURE false) with default
                                  #parameters), except nocache() and csp(). Must call HELMET.FUNC() for individuals:
                                  #Good idea to call it with false for the FEATURE that we want to personalize, then call
                                  #HELMET.FEATURE(...)
HELMET.nocache()                  #Disallow cache by using:
                                  #  Cache-Control: no-store, no-cache
                                  #  Pragma: no-cache
                                  #  Expires: 0
HELMET.csp([OBJ])                 #Implement CSP. OBJ:
                                  #  - default|script|style|img|connect|font|object|media|frameSrc STR_ARR: don't forget quotes
                                  #    on 'self', etc. (def. is only defaultSrc: 'self')
                                  #  - reportUri PATH (def: undefined). Might conflict with csurf
                                  #  - reportOnly BOOL (def: false)
                                  #  - setAllHeaders BOOL (def: false): if true, set headers even when undefined
HELMET.xssFilter()                #Same goal as CSP (XSS-prevention) but using browser-specific mechanism, for IE8+ and Chrome
                                  #only.
HELMET.xframe([STR[, STR2]])      #Implements X-Frame-Options. STR, STR2 can be "deny", "same origin" (def) or
                                  #"allow-from", "PROTOCOL://DOMAIN"
                                  #Should do several time HELMET.xframe() for several time this header.
HELMET.hsts([OBJ])                #Implement Strict-Transport-Security. OBJ:
                                  #  - maxAge NUM (ms)
                                  #  - includeSubdomains BOOL (def: false)
                                  #  - setIf FUNC(REQ, RES)->BOOL: by def., if REQ.secure is true
                                  #To redirect all HTTP connections to HTTPS (using 301 redirection), even initial ones, use
                                  #Express MIDWR EXPRESS-ENFORCES-SSL
HELMET.hidePoweredBy([OBJ])       #Removes X-Powered-By: Express header, to prevent vulnerabilities sniffing.
                                  #Could also use APP.disable("x-powered-by")
                                  #Can change header value with OBJ.setTo STR, e.g. "PHP 4.2.0", to obfuscate sniffing.
HELMET.ienoopen()                 #Uses X-Download-Options: noopen [S]
HELMET.nosniff()                  #Uses X-Content-Type-Options: nosniff [S]
HELMET.crossdomain()              #Adobe products like Flash asks for /crossdomain.xml (if exists) as a policy file.
                                  #Serves a restricted version when asked.
