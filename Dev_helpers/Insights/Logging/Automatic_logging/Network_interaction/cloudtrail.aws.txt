
              
   CLOUDTRAIL  
              



TO DOCUMENT ==>
  - https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/logging_cw_api_calls.html
  - IAM: https://docs.aws.amazon.com/IAM/latest/UserGuide/cloudtrail-integration.html
  - Glacier: https://docs.aws.amazon.com/amazonglacier/latest/dev/audit-logging.html
  - S3:
     - https://docs.aws.amazon.com/AmazonS3/latest/userguide/cloudtrail-logging.html
     - https://docs.aws.amazon.com/AmazonS3/latest/userguide/logging-with-S3.html
     - see common fields with NPAYLOAD (https://docs.aws.amazon.com/AmazonS3/latest/userguide/notification-content-structure.html)
     - JOBs: https://docs.aws.amazon.com/AmazonS3/latest/userguide/batch-ops-examples-event-bridge-cloud-trail.html

VERSION ==>                       #2023-08-01


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:              API              :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


FORMAT ==>                        #JSON
                                  #Request: ?Action and ?Version
                                  #  - except AUDIT_EVENTs: REST

PAGINATION ==>                    #REQ|RES.NextToken STR
                                  #REQ.MaxResults NUM (def|max: 1e3, 50 with EVENT, none with TRAIL|RESOURCE_TAGS|PUBLIC_KEY)

PRICING ==>                       #Free (except S3|SNS costs)


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:          TRAIL MAIN           :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


CreateTrail()                     #Req: TRAIL
                                  #  - no TrailARN, HomeRegion, HasCustomEventSelectors, HasInsightSelectors, SnsTopicARN
                                  #  - LogFileValidationEnabled -> EnableLogFileValidation
                                  #Res: TRAIL
                                  #  - no HomeRegion, HasCustomEventSelectors, HasInsightSelectors, TagsList
UpdateTrail()                     #Req: TRAIL
                                  #  - Name + TrailARN -> Name
                                  #  - no HomeRegion, HasCustomEventSelectors, HasInsightSelectors, SnsTopicARN, TagsList
                                  #  - LogFileValidationEnabled -> EnableLogFileValidation
                                  #Res: TRAIL
                                  #  - no HomeRegion, HasCustomEventSelectors, HasInsightSelectors, TagsList
GetTrail()                        #Req: TRAIL
                                  #  - Name + TrailARN -> Name
                                  #Res: Trail TRAIL
                                  #  - no TagsList
ListTrails()                      #Req: empty
                                  #Res: Trails TRAIL_ARR
                                  #  - only TrailARN, Name, HomeRegion
DescribeTrails()                  #Req: TRAIL_REQ
                                  #Response: trailList TRAIL_ARR
                                  #  - no TagsList
DeleteTrail()                     #Req: TRAIL
                                  #  - Name + TrailARN -> Name
                                  #Res: empty

TRAIL                             #Logs any AWS API calls to a S3 BUCKET
                                  #From both user and SERVICE_DOMAINs
                                  #Only for current REGION
                                  #Max 1 per USER

TRAIL.TrailARN                    #TRAIL_ARN. arn:aws:cloudtrail:REGION:ACCOUNT_ID:trail/TRAIL
TRAIL.Name                        #'TRAIL'. Max 128 chars, [[:alnum:]._-]
TRAIL_REQ.trailNameList           #ARR of 'TRAIL'|TRAIL_ARN


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:         TRAIL REGION          :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


TRAIL.HomeRegion                  #'REGION' of TRAIL

TRAIL.IsMultiRegionTrail          #BOOL (def: false). Whether log SERVICEs from other REGIONs.
DATASTORE.MultiRegionEnabled      #For TRAIL, it duplicates it across REGIONs ("shadow TRAIL").
CHANNEL_SOURCE.ApplyToAllRegions  #  - can be used for CloudTrail ACTIONs, but only readonly ones
                                  #LOG_FILE (but not DIGEST_FILE) for all REGIONs in located in the single HomeRegion

TRAIL_REQ.includeShadowTrails     #BOOL (def: true)

TRAIL.IncludeGlobalServiceEvents  #BOOL (def: true). Whether to log global SERVICEs (e.g. IAM)
                                  #Should set to false in all REGIONs but one


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:         TRAIL STATUS          :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


StartLogging|StopLogging()        #Req: TRAIL
                                  #  - Name + TrailARN -> Name
                                  #Res: empty
                                  #Sets TRAIL_STATUS.IsLogging
GetTrailStatus()                  #Req: TRAIL
                                  #  - Name + TrailARN -> Name
                                  #Res: TRAIL_STATUS

TRAIL_STATUS.IsLogging            #BOOL (def: true). Whether TRAIL is enabled.
TRAIL_STATUS.StartLoggingTime     #Most recent DATE_NUM, if IsLogging true
TRAIL_STATUS.StopLoggingTime      #Most recent DATE_NUM, if IsLogging false


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:          PERMISSIONS          :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


PERMISSIONS ==>                   #Logger is Principal arn:aws:iam::ACCOUNT_ID:root
                                  #  - ACCOUNT_ID is REGION-specific (see online doc for value)
                                  #Must be allowed PACTIONs:
                                  #  - s3:GetBucketAcl on arn:aws:s3:::LOG_BUCKET
                                  #  - s3:PutObject on arn:aws:s3:::LOG_BUCKET/TRAIL_PREFIX/AWSLogs/ACCOUNT_ID/*
                                  #     - with COND_KEY s3:x-amz-acl 'bucket-owner-full-control'
                                  #  (if SNS)
                                  #  - SNS:Publish on arn:aws:sns:REGION:ACCOUNT_ID:TOPIC


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:              SNS              :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


TRAIL.SnsTopicARN                 #SNS_TOPIC_ARN to send on log delivery, with SNS_PAYLOAD
TRAIL.SnsTopicName                #Same as 'SNS_TOPIC'

SNS_PAYLOAD.s3Bucket              #'LOG_BUCKET'
SNS_PAYLOAD.s3ObjectKey           #'LOG_FILE'

TRAIL_STATUS
 .LatestNotificationError
TRAIL_STATUS
 .LatestNotificationTime          #Same as LatestDelivery* but for SNS notifications


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:           LOG FILE            :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


TRAIL.S3BucketName                #S3 'LOG_BUCKET' to store LOG_FILE
                                  #Can use S3 to encrypt, archive|rotate, etc.
TRAIL.S3KeyPrefix                 #'TRAIL_PREFIX' (def: none)

TRAIL|DATASTORE.KmsKeyId          #KMS_KEY_ID

LOG DELIVERY ==>                  #LOG_FILE created every 5 mins
                                  #Calls take 15 mins to come
TRAIL_STATUS.LatestDeliveryTime   #DATE_NUM
TRAIL_STATUS.LatestDeliveryError  #Last log delivery 'ERROR', due to issue with destination BUCKET

TRAIL_PREFIX/AWSLogs/ACCOUNT_ID
 /CloudTrail/REGION/YYYY/MM/DD
 /ACCOUNT_ID_CloudTrail_REGION_
 YYYYMMDDTHHMMZ_RANDOM.json.gz    #'LOG_FILE'

LOG_FILE                          #
LOG_FILE.Records                  #LOG_EVENT_ARR
LOG_EVENT.eventVersion            #Always '1.02'
LOG_EVENT.eventId                 #EVENT_MID
LOG_EVENT.eventTime               #'DATE'
LOG_EVENT.eventSource             #'SERVICE_DOMAIN'
LOG_EVENT.eventName               #'ACTION'
LOG_EVENT.awsRegion               #'REGION'
LOG_EVENT.requestId               #REQ_ID
LOG_EVENT.sourceIPAddress         #'IP'
LOG_EVENT.userAgent               #STR of User-Agent [C]
LOG_EVENT.requestParameters       #PARAMS_OBJ
LOG_EVENT.responseElements        #RESP_OBJ
LOG_EVENT.errorCode               #NUM
LOG_EVENT.errorMessage            #STR

LOG_EVENT.userIdentity            #IDENTITY
IDENTITY|ISSUER.type              #One of: 'IAMUser', 'Root', 'AssumedRole', 'FederatedUser'
IDENTITY|ISSUER.arn               #IDENTITY ARN, e.g. ROLE_ARN
IDENTITY|ISSUER.principalId       #IDENTITY ID, e.g. ROLE_MID
IDENTITY|ISSUER.userName          #'IDENTITY' name, e.g. 'ROLE'
IDENTITY|ISSUER.accountId         #ACCOUNT_ID
IDENTITY.accessKeyId              #ACCESS_KEY_ID
IDENTITY.invokedBy                #'SERVICE_DOMAIN', if called by another SERVICE

IDENTITY.sessionContext           #SESSION_CONTEXT. Only if type 'AssumedRole'
SESSION_CONTEXT.sessionIssuer     #ISSUER
SESSION_CONTEXT.attributes        #SESSION_ATTRS
SESSION_ATTRS.mfaAuthenticated    #'BOOL'
SESSION_ATTRS.creationDate        #'DATE'

IDENTITY.webIdFederationData      #FEDERATION_DATA. Only if type 'FederatedUser'
FEDERATION_DATA.federatedProvider #'DOMAIN'
FEDERATION_DATA.attributes        #STR


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:         LOG INTEGRITY         :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


TRAIL.LogFileValidationEnabled    #BOOL (def: false). Enables digest delivery

DIGEST DELIVERY ==>               #DIGEST_FILE created every 1h
TRAIL_STATUS
 .LatestDigestDeliveryTime        #DATE_NUM
TRAIL_STATUS
 .LatestDigestDeliveryError       #Last log delivery 'ERROR', due to issue with destination BUCKET

TRAIL_PREFIX/AWSLogs[/ORG]
 /ACCOUNT_ID/CloudTrail-Digest
 /REGION/YYYY/MM/DD/ACCOUNT_ID_
 CloudTrail-Digest_REGION_TRAIL_  #'DIGEST_FILE'
 REGION_YYYYMMDDTHHMMSSZ.json.gz  #First 2 REGIONs are of the DIGEST_FILE, last is HomeRegion of TRAIL

DIGEST_FILE                       #List of LOG_FILEs for a given period
                                  #Meant to ensure their integrity
DIGEST_FILE.awsAccountId          #ACCOUNT_ID
DIGEST_FILE.digestStartTime       #'DATE'
DIGEST_FILE.digestEndTime         #'DATE' (1h later)
DIGEST_FILE.oldestEventTime       #'DATE' of first EVENT. Can be < digestStartTime if digest delivery was slow
DIGEST_FILE.newestEventTime       #'DATE' of last EVENT
DIGEST_FILE.digestS3Bucket
DIGEST_FILE.digestS3Object        #'BUCKET|OBJECT' where DIGEST_FILE is located

DIGEST_FILE                       #DIGEST.digestS3Bucket|Object of last DIGEST_FILE
 .previousDigestS3Bucket|Object   #Goal: ensure the full list of DIGEST_FILEs is complete, with no missing DIGEST_FILE
DIGEST_FILE
 .previousDigestHashValue         #'BASE64_SHA256' of last uncompressed DIGEST_FILE
DIGEST_FILE
 .previousDigestHashAlgorithm     #Always 'SHA-256'

DIGEST_FILE.logFiles              #DIGEST_LOG_FILE_ARR
DIGEST_LOG_FILE.s3Bucket
DIGEST_LOG_FILE.s3Object          #'BUCKET|OBJECT' where OBJECT_FILE is located
DIGEST_LOG_FILE.hashValue         #'BASE64_SHA256' of LOG_FILE
                                  #Goal: ensure LOG_FILE's integrity
DIGEST_LOG_FILE.hashAlgorithm     #Always 'SHA-256'
DIGEST_LOG_FILE.oldestEventTime   #'DATE' of first EVENT
DIGEST_LOG_FILE.newestEventTime   #'DATE' of last EVENT


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:          PUBLIC KEYS          :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


ListPublicKeys()                  #Req: PUBLIC_KEY
                                  #  - only ValidityStart|EndTime -> Start|EndTime
                                  #Res: PublicKeyList PUBLIC_KEY_ARR

DIGEST_FILE                       #RSA signature of 'BASE64_SHA256' of last DIGEST_FILE, with AWS private key
 .previousDigestSignature         #Goal: ensure DIGEST_FILE's integrity
DIGEST_FILE
 .digestSignatureAlgorithm        #Always 'SHA256withRSA'
DIGEST_FILE
 .digestPublicKeyFingerprint      #'BASE64_SHA256' of ???

PUBLIC_KEY                        #Used to validate DIGEST_FILE.digestPublicKey
PUBLIC_KEY.Value                  #'BASE64'
PUBLIC_KEY.Fingerprint            #STR
PUBLIC_KEY.ValidityStart|EndTime  #DATE_NUM


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:           SELECTORS           :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


PutEventSelectors()               #Req: SELECTORS
                                  #  - no TrailARN
                                  #Res: SELECTORS
                                  #  - no TrailName
GetEventSelectors()               #Req: SELECTORS
                                  #  - only TrailName
                                  #Res: SELECTORS
                                  #  - no TrailName

TRAIL.HasCustomEventSelectors     #BOOL

SELECTORS.TrailARN                #TRAIL_ARN
SELECTORS.TrailName               #'TRAIL'

SELECTORS|CHANNEL_SOURCE|DATASTORE
 .AdvancedEventSelectors          #ADVANCED_SELECTOR_ARR
ADVANCED_SELECTOR.Name            #STR. Description
ADVANCED_SELECTOR.FieldSelectors  #FIELD_SELECTOR_ARR
FIELD_SELECTOR.Field              #STR
FIELD_SELECTOR
 .[Not]Starts|EndsWith            #STR_ARR
FIELD_SELECTOR.[Not]Equals        #STR_ARR

SELECTORS.EventSelectors          #SELECTOR_ARR
SELECTOR.ReadWriteType            #'All' (def), 'ReadOnly' or 'WriteOnly'
SELECTOR.IncludeManagementEvents  #BOOL
SELECTOR
 .ExcludeManagementEventSources   #STR_ARR
SELECTOR.DataResources            #DATA_RESOURCE_ARR
DATA_RESOURCE.Type                #STR
DATA_RESOURCE.Values              #STR_ARR


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:            CHANNEL            :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


CreateChannel()                   #Req: CHANNEL
                                  #  - no Source, SourceConfig, IngestionStatus
                                  #Res: CHANNEL
                                  #  - no SourceConfig, IngestionStatus
UpdateChannel()                   #Req: CHANNEL
                                  #  - no Source, SourceConfig, IngestionStatus, Tags
                                  #Res: CHANNEL
                                  #  - no SourceConfig, IngestionStatus, Tags
GetChannel()                      #Req: CHANNEL
                                  #  - only ChannelArn -> Channel
                                  #Res: CHANNEL
                                  #  - no Tags
ListChannels()                    #Req: empty
                                  #Res: Channels CHANNEL_ARR
                                  #  - only ChannelArn, Name
DeleteChannel()                   #Req: CHANNEL
                                  #  - only ChannelArn -> Channel
                                  #Res: empty

CHANNEL.ChannelArn                #CHANNEL_ARN. 'aws:aws:cloudtrail:REGION:ACCOUNT_ID:channel/CHANNEL'
CHANNEL.Name                      #'CHANNEL'

CHANNEL.Source                    #STR
CHANNEL.SourceConfig              #CHANNEL_SOURCE

CHANNEL.Destinations              #CHANNEL_DEST_ARR
CHANNEL_DEST.Type                 #STR
CHANNEL_DEST.Location             #STR

CHANNEL.IngestionStatus           #CHANNEL_STATUS
CHANNEL_STATUS
 .LatestIngestionAttemptEventID   #STR
CHANNEL_STATUS
 .LatestIngestionAttemptTime      #DATE_NUM
CHANNEL_STATUS
 .LatestIngestionSuccessEventID   #STR
CHANNEL_STATUS
 .LatestIngestionSuccessTime      #DATE_NUM
CHANNEL_STATUS
 .LatestIngestionErrorCode        #'CODE'


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:            POLICY             :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


PutResourcePolicy()               #Req: RESOURCE_POLICY
                                  #Res: RESOURCE_POLICY
GetResourcePolicy()               #Req: RESOURCE_POLICY
                                  #  - only ResourceArn
                                  #Res: RESOURCE_POLICY
DeleteResourcePolicy()            #Req: RESOURCE_POLICY
                                  #  - only ResourceArn
                                  #Res: empty

RESOURCE_POLICY.ResourceArn       #CLOUDTRAIL_ARN
RESOURCE_POLICY.ResourcePolicy    #IAM 'POLICY'


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:             ORGS              :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


RegisterOrganization              #Req: ORG_ADMIN
 DelegatedAdmin()                 #  - DelegatedAdminAccountId -> MemberAccountId
                                  #Res: empty
DeregisterOrganization            #Req: ORG_ADMIN
 DelegatedAdmin()                 #Res: empty

ORG_ADMIN.DelegatedAdminAccountId #ACCOUNT_ID

TRAIL.IsOrganizationTrail         #BOOL
DATASTORE.OrganizationEnabled     #BOOL

See doc for TRAIL_REQ.includeShadowTrails


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:            INSIGHT            :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


PutInsightSelectors()             #Req: INSIGHT
                                  #  - no TrailARN
                                  #Res: INSIGHT
                                  #  - no TrailName
GetInsightSelectors()             #Req: INSIGHT
                                  #  - only TrailName
                                  #Res: INSIGHT
                                  #  - no TrailName

INSIGHT.TrailARN                  #TRAIL_ARN
INSIGHT.TrailName                 #'TRAIL'
TRAIL.HasInsightSelectors         #BOOL

INSIGHT.InsightSelectors          #INSIGHT_SELECTOR_ARR
INSIGHT_SELECTOR.InsightType      #STR


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:            EVENTS             :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


LookupEvents()                    #Req: EVENTS_REQ
                                  #Res: Events EVENT_ARR

EVENTS_REQ.StartTime|EndTime      #DATE_NUM. Search by EVENT.EventTime
EVENTS_REQ.EventCategory          #STR
EVENTS_REQ.LookupAttributes       #EVENT_ATTR_ARR
EVENT_ATTR.AttributeKey           #STR
EVENT_ATTR.AttributeValue         #STR

EVENT.EventId
EVENT.EventName
EVENT.EventSource
EVENT.EventTime                   #LOG_EVENT.*
EVENT.Username                    #LOG_EVENT.userIdentity.userName
EVENT.CloudTrailEvent             #STR
EVENT.AccessKeyId                 #ACCESS_KEY_ID
EVENT.ReadOnly                    #STR

EVENT.Resources                   #EVENT_RESOURCE_ARR
EVENT_RESOURCE.ResourceType       #STR
EVENT_RESOURCE.ResourceName       #STR


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:          EVENT DATA           :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


POST /PutAuditEvents              #Req: EVENT_DATA_REQ
PutAuditEvents()                  #  - query parameters: channelArn, externalId
                                  #Res: EVENT_DATA_RES

EVENT_DATA_REQ.channelArn         #CHANNEL_ARN
EVENT_DATA_REQ.externalId         #STR, used by COND_KEY sts:ExternalId

EVENT_DATA_REQ.auditEvents        #EVENT_DATA_ARR
EVENT_DATA.id                     #EVENT.EventId
EVENT_DATA.eventData              #STR
EVENT_DATA.eventDataChecksum      #'SHA256_BASE64' of EVENT_DATA.eventData

EVENT_DATA_RES.failed             #FAILED_EVENT_DATA_ARR
FAILED_EVENT_DATA.id              #EVENT.EventId
FAILED_EVENT_DATA.errorCode       #'CODE'
FAILED_EVENT_DATA.errorMessage    #'ERROR'

EVENT_DATA_RES.successful         #SUCCESS_EVENT_DATA_ARR
SUCCESS_EVENT_DATA.id             #Old EVENT.EventId
SUCCESS_EVENT_DATA.eventID        #New EVENT.EventId


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:          DATA STORE           :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


CreateEventDataStore()            #Req: DATASTORE
                                  #  - no EventDataStoreArn, CreatedTimestamp, UpdatedTimestamp, Status
                                  #  - Status 'STARTING_INGESTION' -> StartIngestion BOOL
                                  #Res: DATASTORE
UpdateEventDataStore()            #Req: DATASTORE
                                  #  - no CreatedTimestamp, UpdatedTimestamp, Status, TagsList
                                  #  - EventDataStoreArn -> EventDataStore
                                  #Res: DATASTORE
                                  #  - no TagsList
StartEventDataStoreIngestion()    #Req: DATASTORE
                                  #  - only EventDataStoreArn -> EventDataStore
                                  #Res: empty
                                  #Sets DATASTORE.Status 'STARTING_INGESTION'
StopEventDataStoreIngestion()     #Req: DATASTORE
                                  #  - only EventDataStoreArn -> EventDataStore
                                  #Res: empty
                                  #Sets DATASTORE.Status 'STOPPING_INGESTION'
GetEventDataStore()               #Req: DATASTORE
                                  #  - only EventDataStoreArn -> EventDataStore
                                  #Res: DATASTORE
                                  #  - no TagsList
ListEventDataStores()             #Req: empty
                                  #Res: EventDataStores DATASTORE_ARR
                                  #  - no TagsList
DeleteEventDataStore()            #Req: DATASTORE
                                  #  - only EventDataStoreArn -> EventDataStore
                                  #Res: empty
RestoreEventDataStore()           #Req: DATASTORE
                                  #  - only EventDataStoreArn -> EventDataStore
                                  #Res: DATASTORE
                                  #  - no TagsList

DATASTORE.EventDataStoreArn       #DATASTORE_ARN. 'arn:aws:cloudtrail:REGION:ACCOUNT_ID:eventdatastore/DATASTORE'
DATASTORE.Name                    #'DATASTORE'
DATASTORE.CreatedTimestamp        #DATE_NUM
DATASTORE.UpdatedTimestamp        #DATE_NUM

DATASTORE.Status                  #One of:
                                  #  - 'CREATED'
                                  #  - 'STARTING_INGESTION', 'ENABLED'
                                  #  - 'STOPPING_INGESTING', 'STOPPED_INGESTION'
                                  #  - 'PENDING_DELETION'
DATASTORE.RetentionPeriod         #DATE_NUM
DATASTORE
 .TerminationProtectionEnabled    #BOOL


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:            IMPORT             :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


StartImport()                     #Req: IMPORT
                                  #  - no CreatedTimestamp, UpdatedTimestamp, ImportStatus, ImportStatistics
                                  #Res: IMPORT
                                  #  - no ImportStatistics
GetImport()                       #Req: IMPORT
                                  #  - only ImportId
                                  #Res: IMPORT
ListImports()                     #Req: IMPORT
                                  #  - only Destination STR, ImportStatus
                                  #Res: Imports IMPORT_ARR
                                  #  - no StartEventTime, EndEventTime, ImportSource, ImportStatistics
ListImportFailures()              #Req: IMPORT
                                  #  - only ImportId
                                  #Res: Failures IMPORT_FAILURE_ARR
StopImport()                      #Req: IMPORT
                                  #  - only ImportId
                                  #Res: IMPORT

IMPORT.ImportId                   #'IMPORT'
IMPORT.CreatedTimestamp           #DATE_NUM
IMPORT.UpdatedTimestamp           #DATE_NUM
IMPORT.StartEventTime             #DATE_NUM
IMPORT.EndEventTime               #DATE_NUM

IMPORT.ImportSource.S3            #IMPORT_S3
IMPORT_S3.S3BucketRegion          #'REGION'
IMPORT_S3.S3LocationUri           #STR
IMPORT_S3.S3BucketAccessRoleArn   #ROLE_ARN

IMPORT.Destinations               #STR_ARR

IMPORT.ImportStatus               #STR
IMPORT.ImportStatistics           #IMPORT_STATS
IMPORT_STATS.EventsCompleted      #NUM
IMPORT_STATS.PrefixesCompleted    #NUM
IMPORT_STATS.PrefixesFound        #NUM
IMPORT_STATS.FilesCompleted       #NUM
IMPORT_STATS.FailedEntries        #NUM

IMPORT_FAILURE.ErrorMessage       #STR
IMPORT_FAILURE.ErrorType          #STR
IMPORT_FAILURE.LastUpdatedTime    #DATE_NUM
IMPORT_FAILURE.Location           #STR
IMPORT_FAILURE.Status             #STR


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:             QUERY             :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


StartQuery()                      #Req: QUERY
                                  #  - no QueryId, EventDataStore, QueryResultRows, DeliveryStatus, QueryStatus, ErrorMessage, QueryStatistics
                                  #  - QueryString -> QueryStatement
                                  #Res: QUERY
                                  #  - only QueryId
DescribeQuery()                   #Req: QUERY
                                  #  - only QueryId, QueryAlias
                                  #Res: QUERY
                                  #  - no QueryAlias, EventDataStore, QueryParameters, QueryResultRows
ListQueries()                     #Req: QUERY
                                  #  - only QueryId, QueryStatus, EventDataStore
                                  #  - CreationTime -> StartTime + Endtime DATE_NUM
                                  #Res: Queries QUERY_ARR
                                  #  - only QueryId, CreationTime, QueryStatus
CancelQuery()                     #Req: QUERY
                                  #  - only QueryId
                                  #Res: QUERY
                                  #  - only QueryId, QueryStatus
                                  #Set QUERY.QueryStatus 'CANCELLED'
GetQueryResults()                 #Req: QUERY
                                  #  - only QueryId
                                  #  - MaxResults -> MaxQueryResults
                                  #Res: QUERY
                                  #  - no QueryId, QueryAlias, EventDataStore, QueryString, QueryParameters, DeliveryS3Uri, DeliveryStatus

QUERY.QueryId                     #QUERY_MID
QUERY.QueryAlias                  #STR
QUERY.EventDataStore              #DATASTORE_ARN
QUERY_STATS.CreationTime          #DATE_NUM

QUERY.QueryString                 #STR
QUERY.QueryParameters             #STR_ARR
QUERY.QueryResultRows             #OBJ_ARR_ARR

QUERY.DeliveryS3Uri               #STR
QUERY.DeliveryStatus              #STR

QUERY.QueryStatus                 #STR
QUERY.ErrorMessage                #STR

QUERY.QueryStatistics             #QUERY_STATS
QUERY_STATS.EventsMatched         #NUM
QUERY_STATS.EventsScanned         #NUM
QUERY_STATS.BytesScanned          #NUM
QUERY_STATS.ExecutionTimeInMillis #NUM (in ms)


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:             TAGS              :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


AddTags()                         #Req: RESOURCE_TAGS
                                  #Res: empty
ListTags()                        #Req: RESOURCE_TAGS
                                  #  - only ResourceId -> ResourceIdList ARN_ARR
                                  #Res: ResourceTagList RESOURCE_TAGS_ARR
RemoveTags()                      #Req: RESOURCE_TAGS
                                  #Res: empty

RESOURCE_TAGS.ResourceId          #TRAIL_ARN|CHANNEL_ARN|DATASTORE_ARN
RESOURCE_TAGS.TagsList            #TAG_PAIRS

TRAIL.TagsList
CHANNEL.Tags
DATASTORE.TagsList                #TAG_PAIRS


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:          CLOUDWATCH           :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


TRAIL.CloudWatchLogsLogGroupArn   #STR
TRAIL.CloudWatchLogsRoleArn       #STR

TRAIL_STATUS.LatestCloudWatchLogs
 DeliveryError                    #'ERROR'
TRAIL_STATUS.LatestCloudWatchLogs
 DeliveryTime                     #DATE_NUM
