
                                  ┏━━━━━━━━━┓
                                  ┃   SNS   ┃
                                  ┗━━━━━━━━━┛

VERSION ==>                       #2024-09-24

TODO:
  - https://docs.aws.amazon.com/sns/latest/api/welcome.html
  - https://docs.aws.amazon.com/sns/latest/dg/welcome.html
  - check sns_backup.txt in Desktop
  - Lambda:
     - https://github.com/aws/aws-cdk/blob/8ce02838ba5033a6b35123a34e444c4f35350975/packages/aws-cdk-lib/aws-lambda-event-sources/lib/sns.ts
        - https://github.com/aws/aws-cdk/tree/8ce02838ba5033a6b35123a34e444c4f35350975/packages/aws-cdk-lib/aws-lambda-event-sources#sns
  - CloudWatch Logs:
     - revisit MASK_POLICY, since it seems to be a subset of SNS's
  - https://github.com/awslabs/amazon-sns-python-extended-client-lib and https://github.com/awslabs/amazon-sns-java-extended-client-lib
     - see SQS doc, which has same concept
  - SAM:
     - https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/sam-property-function-sns.html
     - see example of how to document this with AWS::Serverless::Function documentation in CloudWatch Logs
     - test locally using sam-translate binary
     - move documentation about AWS::Serverless::Connector
     - move POLICY_TEMPLATE doc from SAM transform doc
  - Application Composer
     - connection from SNS TOPIC to SQS QUEUE (creating a SUBSCRIPTION)
     - connection from S3 BUCKET to SNS TOPIC
  - https://github.com/Admiral-Piett/goaws
     - see current doc of `goaws`, moving the SNS-specific part at the bottom
     - see https://github.com/Admiral-Piett/goaws README for SNS

                                  ┌─────────┐
                                  │   API   │
                                  └─────────┘

SERVICE_DOMAIN                    #sns.amazonaws.com

SVERSION                          #'2010-03-31'

FORMAT ==>                        #Request: query parameters (ARR uses VAR.NUM)
                                  #Response: XML
                                  #Uses REQ.Action|Version

REQ_ID                            #RES.ResponseMetadata.RequestId

PAGINATION ==>                    #Uses REQ|RES.NextToken
                                  #Uses REQ.MaxResults only with:
                                  #  - ListOriginationNumbers() (def|max 30)
                                  #  - ListSMSSandboxPhoneNumbers() (def|max 100)
                                  #No pagination: ListTagsForResource()

CreateTopic()                     #Req: TOPIC
                                  #  - no TopicArn
                                  #  - Attributes: no Owner, EffectiveDeliveryPolicy, Subscriptions*,
                                  #    BeginningArchiveTime, SERVICE*
                                  #Res: TOPIC
                                  #  - only TopicArn
SetTopicAttributes()              #Req: TOPIC
                                  #  - only TopicArn, Attributes -> AttributeName 'TOPIC_ATTR', AttributeValue STR
                                  #  - Attributes: no Owner, EffectiveDeliveryPolicy, Subscriptions*,
                                  #    BeginningArchiveTime, FifoTopic
                                  #Res: empty
ListTopics()                      #Req: empty
                                  #Res: Topic TOPIC_ARR
                                  #  - only TopicArn
GetTopicAttributes()              #Req: TOPIC
                                  #  - only TopicArn
                                  #Res:
                                  #  - only Attributes: no SERVICE*
                                  #  - only TopicArn -> Attributes.TopicArn
DeleteTopic()                     #Req: TOPIC
                                  #  - only TopicArn
                                  #Res: empty

TOPIC.TopicArn                    #
TOPIC.Name                        #
TOPIC_ATTRS.Owner                 #
TOPIC.Attributes                  #TOPIC_ATTRS

TOPIC_ATTRS.DeliveryPolicy        #
TOPIC_ATTRS
 .EffectiveDeliveryPolicy         #

TOPIC_ATTRS.SubscriptionsConfirmed#
TOPIC_ATTRS.SubscriptionsDeleted  #
TOPIC_ATTRS.SubscriptionsPending  #

TOPIC_ATTRS.TracingConfig         #

TOPIC_ATTRS.DisplayName           #

TOPIC_ATTRS.SERVICE*              #SERVICE can be HTTP, Firehose, Lambda, Application, SQS
TOPIC_ATTRS.
 SERVICESuccessFeedbackRoleArn    #
TOPIC_ATTRS.
 SERVICESuccessFeedbackSampleRate #
TOPIC_ATTRS.
 SERVICEFailureFeedbackRoleArn    #

TOPIC_ATTRS.KmsMasterKeyId        #
TOPIC_ATTRS.SignatureVersion      #

TOPIC_ATTRS.FifoTopic             #
TOPIC_ATTRS.BeginningArchiveTime  #
TOPIC_ATTRS.ArchivePolicy         #
TOPIC_ATTRS
 .ContentBasedDeduplication       #

Subscribe()                       #Req: SUB
                                  #  - no SubscriptionArn, Owner
                                  #  - Attributes: no *Confirmation*, EffectiveDeliveryPolicy
                                  #Res: SUB
                                  #  - only SubscriptionArn
SetSubscriptionAttributes()       #Req: SUB
                                  #  - only SubscriptionArn, Attributes -> AttributeName 'SUB_ATTR', AttributeValue STR
                                  #  - Attributes: no *Confirmation*, EffectiveDeliveryPolicy, Replay*
                                  #Res: empty
ListSubscriptions()               #Req: empty
                                  #Res: Subscriptions SUB_ARR
                                  #  - no Attributes, ReturnSubscriptionArn
ListSubscriptionsByTopic()        #Req: SUB
                                  #  - only TopicArn
                                  #Res: Subscriptions SUB_ARR
                                  #  - no Attributes, ReturnSubscriptionArn
GetSubscriptionAttributes()       #Req: SUB
                                  #  - only SubscriptionArn
                                  #Res: SUB
                                  #  - only Attributes: no Replay*
                                  #  - only Owner|*Arn -> Attributes.Owner|*Arn
Unsubscribe()                     #Req: SUB
                                  #  - only SubscriptionArn
                                  #Res: empty

SUB.SubscriptionArn               #
SUB.TopicArn                      #
SUB.Owner                         #
SUB.Attributes                    #SUB_ATTRS

SUB.Protocol                      #
SUB.Endpoint                      #

SUB_ATTRS.DeliveryPolicy          #
SUB_ATTRS.EffectiveDeliveryPolicy #

SUB_ATTRS.FilterPolicy            #
SUB_ATTRS.FilterPolicyScope       #

SUB_ATTRS.RawMessageDelivery      #

SUB_ATTRS.RedrivePolicy           #

SUB_ATTRS.ReplayPolicy            #
SUB_ATTRS.ReplayStatus            #

SUB_ATTRS.SubscriptionRoleArn     #

ConfirmSubscription()             #Req: SUB_CONFIRM
                                  #Res: SUB
                                  #  - only SubscriptionArn

SUB_CONFIRM.TopicArn              #

SUB_CONFIRM.Token                 #

SUB_CONFIRM
 .AuthenticateOnUnsubscribe       #

SUB.ReturnSubscriptionArn         #
SUB_ATTRS.PendingConfirmation     #
SUB_ATTRS
 .ConfirmationWasAuthenticated    #

Publish()                         #Req: MESSAGE
                                  #Res: MESSAGE_RES

MESSAGE_RES.MessageId             #
MESSAGE.TopicArn                  #
MESSAGE.TargetArn                 #

MESSAGE.Message                   #
MESSAGE.MessageStructure          #

MESSAGE
 .MessageAttributes.MESSAGE_ATTR  #ATTR_VALUE
ATTR_VALUE.DataType               #Value's type among 'String', 'String.Array', 'Number' or 'Binary'
                                  #Can append with any '.DESCRIPTION', e.g. 'Number.float', max 256 chars
ATTR_VALUE.StringValue            #STR. Value, when DataType 'String[.Array]|Number'
                                  #'NUM' must be single-precision float
ATTR_VALUE.BinaryValue            #STR. Value, when DataType 'Binary'
                                  #Must be base64'd

MESSAGE.Subject                   #

MESSAGE.PhoneNumber               #

MESSAGE.MessageGroupId            #
MESSAGE_RES.SequenceNumber        #
MESSAGE.MessageDeduplicationId    #

PublishBatch()                    #Req: BATCH
                                  #Res: BATCH_RES

BATCH.TopicArn                    #'TOPIC_ARN'
BATCH.PublishBatchRequestEntries  #BATCH_ENTRY_ARR
BATCH_ENTRY.Id                    #'BATCH_ENTRY_MID'
BATCH_ENTRY.*                     #MESSAGE.* except no TopicArn, TargetArn, PhoneNumber

BATCH_RES.Successful              #BATCH_SUCCESS_ARR
BATCH_SUCCESS.Id                  #'BATCH_ENTRY_MID'
BATCH_SUCCESS.*                   #MESSAGE_RES

BATCH_RES.Failed                  #BATCH_ERROR_ARR
BATCH_ERROR.Id                    #'BATCH_ENTRY_MID'
BATCH_ERROR.Code                  #'CODE'
BATCH_ERROR.Message               #'MESSAGE'
BATCH_ERROR.SenderFault           #BOOL. Whether caused by user or by API

AddPermission()                   #Req: PERMISSION
                                  #Res: empty
RemovePermission()                #Req: PERMISSION
                                  #  - only TopicArn, Label
                                  #Res: empty

TOPIC_ATTRS.Policy                #

PERMISSION                        #Sets TOPIC_ATTRS.Policy
                                  #POLICY_DOC.Id is 'arn:aws:sqs:REGION:ACCOUNT_ID/TOPIC/SNSDefaultPolicy'
PERMISSION.Label                  #STATEMENT.Sid
PERMISSION.TopicArn               #'TOPIC_ARN'. STATEMENT.Resource
PERMISSION.ActionName             #'PACTION|*'_ARR. STATEMENT.Actions
PERMISSION.AWSAccountIds          #'ACCOUNT_ID'_ARR. STATEMENT.Principal.AWS
                                  #Required

PutDataProtectionPolicy()         #Req: TOPIC
                                  #  - only DataProtectionPolicy, TopicArn -> ResourceArn
                                  #Res: empty
GetDataProtectionPolicy()         #Req: TOPIC
                                  #  - only TopicArn -> ResourceArn
                                  #Res: TOPIC
                                  #  - only DataProtectionPolicy

TOPIC.DataProtectionPolicy        #

TagResource()                     #Req: TOPIC_TAGS
                                  #Res: empty
ListTagsForResource()             #Req: TOPIC_TAGS
                                  #  - only ResourceArn
                                  #Res: TOPIC_TAGS
                                  #  - only Tags
UntagResource()                   #Req: TOPIC_TAGS
                                  #  - Tags OBJ -> TagKeys STR_ARR
                                  #Res: empty

TOPIC_TAGS.ResourceArn            #'TOPIC_ARN'
TOPIC[_TAGS].Tags                 #TAG_PAIRS

SetSMSAttributes()                #Req: SMS_SETTINGS
                                  #Res: empty
GetSMSAttributes()                #Req: SMS_SETTINGS
                                  #  - attributes OBJ -> 'SMS_ATTR'_ARR
                                  #Res: SMS_SETTINGS

SMS_SETTINGS.attributes           #
SMS_ATTRS.MonthlySpendLimit       #
SMS_ATTRS.DeliveryStatusIAMRole   #
SMS_ATTRS
.DeliveryStatusSuccessSamplingRate#
SMS_ATTRS.DefaultSenderID         #
SMS_ATTRS.DefaultSMSType          #
SMS_ATTRS.UsageReportS3Bucket     #

ListOriginationNumbers()          #Req: empty
                                  #Res: PhoneNumbers SMS_SENDER_ARR

SMS_SENDER.CreatedAt              #
SMS_SENDER.Iso2CountryCode        #
SMS_SENDER.NumberCapabilities     #
SMS_SENDER.PhoneNumber            #
SMS_SENDER.RouteType              #
SMS_SENDER.Status                 #

OptInPhoneNumber()                #Req: SMS_RECEIVER
                                  #  - no isOptedOut
                                  #Res: empty
ListPhoneNumbersOptedOut()        #Req: empty
                                  #Res: phoneNumbers 'PHONE_NUMBER'_ARR
CheckIfPhoneNumberIsOptedOut()    #Req: SMS_NUMBER
                                  #  - no isOptedOut
                                  #Res: SMS_NUMBER
                                  #  - only isOptedOut

SMS_RECEIVER.phoneNumber          #'PHONE_NUMBER'
SMS_RECEIVER.isOptedOut           #

CreateSMSSandboxPhoneNumber()     #Req: SMS_SANDBOX
                                  #  - no Status
                                  #Res: empty
VerifySMSSandboxPhoneNumber()     #Req: SMS_SANDBOX
                                  #  - only PhoneNumber
                                  #  - only one with OneTimePassword
                                  #Res: empty
ListSMSSandboxPhoneNumbers()      #Req: empty
                                  #Res: PhoneNumbers SMS_SANDBOX_ARR
                                  #  - no LanguageCode
GetSMSSandboxAccountStatus()      #Req: empty
                                  #Res: SMS_SANDBOX
                                  #  - only one with IsInSandbox
DeleteSMSSandboxPhoneNumber()     #Req: SMS_SANDBOX
                                  #  - only PhoneNumber
                                  #Res: empty

SMS_SANDBOX.PhoneNumber           #'PHONE_NUMBER'
SMS_SANDBOX.LanguageCode          #
SMS_SANDBOX.Status                #
SMS_SANDBOX.IsInSandbox           #
SMS_SANDBOX.OneTimePassword       #

CreatePlatformApplication()       #Req: APP
                                  #  - no PlatformApplicationArn
                                  #  - Attributes: no AppleCertificateExpiryDate, AuthenticationMethod,
                                  #    *FeedbackRoleArn, SuccessFeedbackSampleRate
                                  #Res: APP
                                  #  - only PlatformApplicationArn
SetPlatformApplicationAttributes()#Req: APP
                                  #  - only PlatformApplicationArn, Attributes
                                  #  - Attributes: no AppleCertificateExpiryDate, AuthenticationMethod,
                                  #    *FeedbackRoleArn, SuccessFeedbackSampleRate
                                  #Res: empty
ListPlatformApplications()        #Req: empty
                                  #Res: PlatformApplications APP_ARR
                                  #  - only PlatformApplicationArn, Attributes
GetPlatformApplicationAttributes()#Req: APP
                                  #  - only PlatformApplicationArn
                                  #Res: APP
                                  #  - only Attributes: no PlatformCredential, PlatformPrincipal
DeletePlatformApplication()       #Req: APP
                                  #  - only PlatformApplicationArn
                                  #Res: empty

APP.PlatformApplicationArn        #
APP.Name                          #
APP.Attributes                    #APP_ATTRS

APP.Platform                      #

APP_ATTRS.PlatformCredential      #
APP_ATTRS.PlatformPrincipal       #
APP_ATTRS.SuccessFeedbackRoleArn  #
APP_ATTRS.FailureFeedbackRoleArn  #
APP_ATTRS
 .SuccessFeedbackSampleRate       #
APP_ATTRS
 .AppleCertificateExpiryDate      #
APP_ATTRS.ApplePlatformTeamID     #
APP_ATTRS.ApplePlatformBundleID   #
APP_ATTRS.AuthenticationMethod    #
APP_ATTRS.EventEndpointCreated    #
APP_ATTRS.EventEndpointDeleted    #
APP_ATTRS.EventEndpointUpdated    #
APP_ATTRS.EventDeliveryFailure    #

CreatePlatformEndpoint()          #Req: ENDPOINT
                                  #  - no EndpointArn
                                  #Res: ENDPOINT
                                  #  - only EndpointArn
SetEndpointAttributes()           #Req: ENDPOINT
                                  #  - only EndpointArn, Attributes
                                  #  - CustomUserData|Token -> Attributes.*
                                  #Res: empty
ListEndpointsByPlatformApplication#Req: ENDPOINT
 ()                               #  - only PlatformApplicationArn
                                  #Res: Endpoints ENDPOINT_ARR
                                  #  - only EndpointArn, Attributes
GetEndpointAttributes()           #Req: ENDPOINT
                                  #  - only Attributes
                                  #  - CustomUserData|Token -> Attributes.*
                                  #Res: empty
DeleteEndpoint()                  #Req: ENDPOINT
                                  #  - only EndpointArn
                                  #Res: empty

ENDPOINT.EndpointArn              #
ENDPOINT.PlatformApplicationArn   #
ENDPOINT.Attributes               #ENDPOINT_ATTRS

ENDPOINT_ATTRS.Enabled            #

ENDPOINT.Token                    #
ENDPOINT.CustomUserData           #
