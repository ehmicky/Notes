
             
   POSTGREST  
             




VERSION ==>                       #11.1.0
                                  #Proxies postgres server to expose it as a REST API

postgrest                         #Start server

postgrest CONF_PATH               #PATH to CONF
                                  #INI format
postgrest --dump-config           #Print CONF

CONF.db-uri                       #'LIBPQ' connection (def: 'postgresql://') to the postgres server
                                  #Also indicates which DATABASE to use

CONF.server-host                  #STR (def: '!4'). Host of the postgrest server
CONF.server-port                  #NUM (def: 3000). Port of the postgrest server
CONF.server-unix-socket           #'PATH' to Unix socket of the postgrest server
CONF.server-unix-socket-mode      #STR (def: '600'). Permissions of Unix socket

CONF.admin-server-port            #NUM (def: none). Port of admin server used for checks

CONF.db-anon-role                 #"ROLE" to use for unauthenticated clients
                                  #"ROLE" of CONF.db-uri switches to it using `set role 'ROLE'`
                                  #  - i.e. must be a member of it
                                  #  - also means "ROLE" can be `nologin`
                                  #Def: uses CONF.db-uri ROLE
CONF.db-pre-request               #"FUNC" called after any client authentication

CONF.db-schemas                   #"SCHEMA" (def: "public") being exposed in REST routes
CONF.db-extra-search-path         #"SCHEMA" (def: "public") to prepend to SCONF.search_path

CONF.db-channel                   #"CHANNEL" (def: "pgrst") notified on schema cache reload
CONF.db-channel-enabled           #BOOL (def: true). Enable CONF.db-channel

CONF.db-pre-config                #"FUNC" used for in-database configuration
CONF.db-config                    #BOOL (def: true). Enable CONF.db-pre-config

CONF.db-root-spec                 #STR (def: '')

CONF.db-max-rows                  #Max NUM (def: unlimited) of ROWs per response

CONF.db-plan-enabled              #BOOL (def: false). Allow runing `explain` using Accept: application/vnd.pgrst.plan [C]

CONF.db-pool                      #NUM (def: 10) of sockets to keep in pool
CONF.db-pool-acquisition-timeout  #NUM (def: 10) of secs to wait for a socket in pool
CONF.db-pool-max-idletime         #NUM (def: 30s) of secs to keep unused sockets in pool
CONF.db-pool-max-lifetime         #NUM (def: 30min) of secs to keep sockets in pool (used or not)

CONF.db-prepared-statements       #BOOL (def: true). Enable PREPs
                                  #Might need to disable when behind a connection pooler

CONF.db-tx-end                    #Whether to allow using Prefer: tx=commit|rollback [C] to commit|rollback current transaction
                                  #Can be:
                                  #  - 'commit' (def): does not allow
                                  #  - 'commit-allow-override': allows
                                  #  - 'rollback[-allow-override]': same but defaults to always rolling back

CONF.jwt-aud                      #STR (def: ''). JWT claim
CONF.jwt-role-claim-key           #'VARR' (def: '.role') to ROLE claim key
CONF.jwt-secret                   #STR (def: ''). Secret of the JWT
                                  #Can be '@PATH' to a file
                                  #Min 32 chars
CONF.jwt-secret-is-base64         #BOOL (def: false)

CONF.log-level                    #Among: 'crit', 'error' (def), 'warn', 'info'

CONF.openapi-mode                 #Whether OpenAPI route is:
                                  #  - 'disabled'
                                  #  - 'follow-provileges' (def): enabled
                                  #  - 'ignore-privileges': same but does not take into account ROLE PRIVILEGEs
                                  #Served as JSON
                                  #OpenAPI version 2.0
CONF.openapi-server-proxy-uri     #'URL' (def: '', i.e. root) of OpenAPI route
CONF.openapi-security-active      #BOOL (def: false)

Server: postgrest/X.Y.Z [S]       #Returned from responses

CONF.raw-media-types              #'MIME,...' (def: '') of raw output

CONF.server-trace-header          #STR (def: '')

application/json [C|S]
application/
 vnd.pgrst.object+json [C|S]      #Request|response JSON payload
text/csv [C|S]                    #Request|response CSV payload

GET /RESOURCE                     #select * from TABLE
                                  #Returned as OBJ_ARR, cast to JSON
?COL=OP.VAL                       #where COL OP VAL [and ...]
?COL=eq.VAL                       #=

?select=VARR                      #

?order=VARR                       #

?on_conflict=STR                  #

?offset=STR                       #
?limit=STR                        #
Range: STR [C]                    #
Range-Unit: STR [C]               #Def: 'items'

Prefer: single-object [C]
Prefer: return=representation [C]
Prefer: return=minimal [C]
Prefer: return=none [C]
Prefer: count=none [C]
Prefer: resolution=ignore-duplicates [C]
Prefer: resolution=merge-duplicates [C]
