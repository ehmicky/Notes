
          
   PRISMA  
          



To do:
  - Prisma Client:
     - in Reference: https://www.prisma.io/docs/reference/api-reference/prisma-client-reference
     - Error Reference: https://www.prisma.io/docs/reference/api-reference/error-reference
     - in Concepts: https://www.prisma.io/docs/concepts/components/prisma-client
  - Relations: https://www.prisma.io/docs/concepts/components/prisma-schema/relations
     - also https://www.prisma.io/docs/concepts/components/introspection#relations
  - Prisma Data Platform: https://www.prisma.io/docs/data-platform
  - pricing
  - Get started: https://www.prisma.io/docs/getting-started
  - All guides:
     - except:
        - Seeding your database
        - Schema prototyping with db push
     - including:
        - Deno deploy
  - fix all `???` in this doc
  - https://github.com/prisma
  - https://www.prisma.io/docs/concepts/components/prisma-schema/generators#community-generators


VERSION ==>                       #5.4.2 (2023-10-16)

OPEN-SOURCE ==>                   #Most of it except:
                                  #  - studio
                                  #  - Accelerate
                                  #  - Proxy
                                  #  - Pulse

NON-GOALS ==>                     #Not meant as full BaaS:
                                  #  - no database hosting
                                  #  - no API hosting
                                  #  - no API generation by default (although can be done with generators)


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:              CLI              :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


prisma                            #CLI

prisma version                    #Version of prisma CLI|client|studio and current OS

ENVVAR PRISMA_HIDE_UPDATE_MESSAGE #Do not print version upgrade warning
ENVVAR PRISMA_DISABLE_WARNINGS    #Do not print any warnings

ENVVAR CHECKPOINT_DISABLE=1       #Do not send anonymous CLI usage telemetry


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:            ENGINES            :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


ENGINE ==>                        #Rust libraries used by the TypeScript components (CLI, CLIENT)

PSL ==>                           #Engine used to parse|serialize|validate|format SCHEMA
                                  #Used by schema|format|query engines, i.e. as a Rust dependency

SCHEMA ENGINE ==>                 #Engine used by `schema db|migrate`
                                  #Downloaded as postinstall script during `npm install prisma`
                                  #Def: inside node_modules/@prisma/engines/...
                                  #Runs as a separate executable file, as a HTTP server

FORMAT ENGINE ==>                 #Engine used by `schema format`
                                  #Loaded by CLI as WASM dependency

QUERY ENGINE ==>                  #Engine performing database queries, used by both the CLI and the CLIENT
                                  #Pools database connections on local machine
                                  #Downloaded the same way as schema engine
                                  #Loaded either as a:
                                  #  - library (def):
                                  #     - embedded in library, as a Node.js addon
                                  #     - takes more space, which is an issue inside serverless functions
                                  #  - binary:
                                  #     - separate executable file, as a HTTP server
                                  #     - slower due to IPC

generator.engineType
ENVVAR PRISMA_CLIENT_ENGINE_TYPE  #ENUM library|binary. How query engine should be used by CLIENT
ENVVAR
 PRISMA_CLI_QUERY_ENGINE_TYPE     #Same but for query engine used by CLI

schema generate --no-engine       #When using neither Data Proxy nor Accelerate
ENVVAR PRISMA_GENERATE_NO_ENGINE  #With "prisma-client-js" only

ENVVAR PRISMA_SCHEMA_ENGINE_BINARY#'PATH' to schema engine binary
ENVVAR PRISMA_QUERY_ENGINE_LIBRARY#'PATH' to query engine binary (Node.js addon)
                                  #Only with engineType 'library'
ENVVAR PRISMA_QUERY_ENGINE_BINARY #'PATH' to query engine binary (executable file)
                                  #Only with engineType 'binary'

ENVVAR PRISMA_ENGINES_MIRROR      #URL where to download schema|query engine binaries
                                  #Def: https://binaries.prisma.sh
ENVVAR PRISMA_ENGINES_
 CHECKSUM_IGNORE_MISSING          #Unless set, verify checksum of schema|query engine binaries

generator.binaryTargets           #STR_ARR. OS|CPU targets of schema|query engines to download, i.e. where CLI and client will run
ENVVAR PRISMA_CLI_BINARY_TARGETS  #Can be:
                                  #  - "native" (def): current
                                  #  - "debian-openssl-X.Y.x": Debian|Ubuntu|Mint|ArchLinux
                                  #  - "rhel-openssl-X.Y.x": Fedora|CentOS
                                  #  - "linux-musl[-arm64][-openssl-3.0.x]": Alpine >=|< 3.17, x86|ARM64
                                  #  - "linux-arm64-openssl-X.Y.x": other Linux ARM64, glibc
                                  #  - "darwin[-arm64]"
                                  #  - "windows"

ENVVAR DEBUG=engine               #Debug logs


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:           PREVIEWS            :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


prisma --preview                  #Required for CLI experimental features

generator.previewFeatures         #STR_ARR. Required for SCHEMA|CLIENT experimental PREVIEW features

ENVVAR
 PRISMA_HIDE_PREVIEW_FLAG_WARNINGS#Do not warn on PREVIEWs


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:        SCHEMA GENERAL         :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


SCHEMA ==>                        #Defines data model in a declarative way

FORMAT ==>                        #PSL ("Prisma Schema Language"). GraphQL-like

prisma validate                   #Validate SCHEMA
prisma format                     #Validate and prettify SCHEMA, saving on-file

prisma init                       #Scaffold ./prisma/schema.prima and ./.env

prisma generate|validate|format
 |studio
prisma db pull|push|execute       #PATH to SCHEMA
prisma migrate dev|reset|deploy   #Def:
 |resolve|status                  #  - package.json prisma.schema 'PATH'
--schema=PATH                     #  - [.../]./[prisma/]schema.prisma

VSCODE EXTENSION ==>              #SCHEMA's syntax highlighting, linting, autocomplete, formatting, jump-to-definition, hovering help
                                  #There is also for other IDEs

```prisma
...
```                               #Can be used on GitHub

//COMMENT                         #
///COMMENT                        #Same but present when parsing as AST, i.e. can be used by tooling

env("ENVVAR")                     #"VAL"
                                  #Only for datasource.url and generator.binaryTargets
.env                              #Dotenv is parsed, to set any of the ENVVARs
                                  #Must be in same DIR as SCHEMA


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:       SCHEMA DATASOURCE       :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


datasource DB {
  VAR = VAL                       #Database
  ...                             #Only one per schema
}                                 #DB is often "db"
POPTS.datasources.DB              #Same as OBJ
                                  #Cannot set provider

datasource.provider               #"DB_PROVIDER". Database type ("connector") among:
prisma init --datasource-provider #  - "postgresql" (>=9.6), "mysql", "sqlserver"
                                  #  - "sqlite"
                                  #  - "cockroachdb"
                                  #  - "mongodb" (>=4.2)
datasource.url                    #Connection "URL" to the main database, through connection pooler if any
POPTS.datasourceUrl               #E.g.:
prisma init --url                 #  - Postgres: 'LIBPQ'
                                  #  - SQLite: 'file:./PATH.db'
datasource.directUrl              #Connection "URL" to the main database, without connection pooler if any
                                  #Used with prisma db|migrate|studio
                                  #Def: same as datasource.url

@prisma/adapter-*                 #ADAPTER
                                  #Fixes database connection for specific providers: neon, PlanetScale, turso
                                  #Requires PREVIEW driverAdapters
POPTS.adapter                     #ADAPTER

LIBPQ.*                           #In connection 'URL', different from Postgres ones
LIBPQ.options|host|connect_timeout
 |application_name|sslcert
 |sslpassword|channel_binding     #Like Postgres
LIBPQ.schema                      #'SCHEMA'
LIBPQ.socket_timeout              #NUM (def: none). Query timeout
LIBPQ.connection_limit            #NUM (def: CPUs * 2 + 1). Keep pool of connections
LIBPQ.pool_timeout                #NUM (in sec, def: 10). If pool empty, how long to wait
LIBPQ.sslidentity                 #Like Postgres LIBPQ.ssl_key_file
LIBPQ.sslcert                     #Like Postgres LIBPQ.ssl_cert_file
LIBPQ.sslmode                     #Like Postgres, but no "allow" nor "verify-*"
LIBPQ.sslaccept                   #'accept_invalid_certs' (def) or 'strict'
                                  #Whether to allow missing values in certificates
LIBPQ.pgbouncer                   #BOOL (def: false). When using pgBouncer

datasource.extensions             #ARR of EXTENSION[(ARG: "VAL",...)]
                                  #Postgres EXTENSIONs. ARGs (all optional):
                                  #  - version "EVERSION"
                                  #  - schema "SCHEMA"
                                  #  - map "EXTENSION2": like @map but for "EXTENSION"
                                  #Requires PREVIEW postgresqlExtensions


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:      SCHEMA TYPE COMPLEX      :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


model MODEL {
  FIELD FTYPE [@ATTR]...          #Database TABLE
  ...                             #Can use MODEL as FTYPE
  [@@ATTR]                        #With any database
  ...                             #JavaScript client: OBJ|ARR
}                                 #In schema: ???

view VIEW { ... }                 #Database VIEW
                                  #Same syntax and behavior as MODEL
                                  #With any database
                                  #Requires PREVIEW views
./prisma/views/SCHEMA/VIEW.sql    #SQL query of VIEW
                                  #Created by `prisma db pull`

type OBJ_TYPE { ... }             #"Composite type"
                                  #Same syntax as `model MODEL`
                                  #No @unique, @id, @relation, @ignore, @updatedAt
                                  #Can use OBJ_TYPE as FTYPE
                                  #Only with MongoDB
                                  #JavaScript client: OBJ
                                  #In schema: ???

enum ENUM { ... }                 #Same syntax as `model MODEL`, except no FTYPE
                                  #Only @[@]map
                                  #Can use ENUM as FTYPE
                                  #Postgres|MySQL|CDB: enum type
                                  #MondoDB: done at ORM-level
                                  #Not with SQLite nor SQL server
                                  #JavaScript client: ???
                                  #In schema: FIELD

MODEL|VIEW|ENUM|OBJ_TYPE          #Name must be [[:alnum:]_] and not start with _ nor digit
                                  #Usually CamelCase, singular
                                  #Cannot be one of the JavaScript reserved keywords, nor "Prisma[Client]"

FIELD                             #Database COL name
                                  #Must be [[:alnum:]_] and not start with _ nor digit
                                  #Usually camelCase
                                  #Cannot be "AND|OR|NOT"

FIELD_VARR                        #FIELD name
                                  #Can be dot-delimited for OBJ_TYPE

FTYPE?                            #Optional FTYPE
                                  #Most databases: `not null`
                                  #MongoDB: done at ORM-level
                                  #Implies @default null

FTYPE[]                           #ARR ("list")
                                  #Not with SQLite, MySQL, SQL server
                                  #Cannot be FTYPE[]? nor FTYPE?[]


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:      SCHEMA TYPE SIMPLE       :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


String                            #Postgres: text, MongoDB: String, SQLite: TEXT, also MySQL, SQL server, CDB
                                  #JavaScript client: STR
                                  #In schema: "..."
String @db.Text                   #Postgres: text, SQLite: TEXT, also MySQL, SQL server
String @db.Char(NUM)              #Postgres: char(NUM), also MySQL, SQL server, CDB
String @db.VarChar(NUM)           #Postgres: varchar(NUM), also MySQL, SQL server
String @db.Bit(NUM)               #Postgres: bit(NUM), also CDB
String @db.VarBit                 #Postgres: varbit, also CDB
String @db.Uuid                   #Postgres: uuid, also CDB
String @db.Xml                    #Postgres: xml, also SQL server
String @db.Inet                   #Postgres: inet, also CDB
String @db.Citext                 #Postgres: citext
String @db.Tiny|Medium|LongText   #Only MySQL
String @db.NText                  #Only SQL server
String @db.N[Var]Char(NUM)        #Only SQL server
String @db.UniqueIdentifier       #Only SQL server
String @db.CatalogSingleChar      #Only CDB
String @db.String                 #MongoDB: String, also CDB
String @db.ObjectId               #MongoDB: String, as objectId

Boolean                           #Postgres: boolean, MongoDB: Bool, SQLite: INTEGER, also MySQL, SQL server, CDB
                                  #JavaScript client: BOOL
                                  #In schema: true|false
Boolean @db.Boolean               #Postgres: boolean
Boolean @db.TinyInt(NUM)          #Only MySQL
Boolean @db.Bool                  #Only CDB
Boolean @db.Bit                   #MongoDB: bit, also MySQL

Int                               #Postgres: int4, MongoDB: Int, SQLite: INTEGER, also MySQL, SQL server, CDB
                                  #JavaScript client: NUM
                                  #In schema: INT
Int @db.SmallInt                  #Postgres: int2, also MySQL, SQL server
Int @db.Integer                   #Postgres: int4
Int @db.Oid                       #Postgres: oid
Int @db.Int                       #MongoDB: Int, also MySQL, SQL server
Int @db.TinyInt                   #Only MySQL, SQL server
Int @db.MediumInt                 #Only MySQL
Int @db
 .Unsigned[Tiny|Small|Medium]Int  #Only MySQL
Int @db.Year                      #Only MySQL
Int @db.Bit                       #Only SQL server
Int @db.Int2|4|8                  #Only CDB
Int @db.Long                      #MongoDB: Long

BigInt                            #Postgres: int8, MongoDB: Long, SQLite: INTEGER, also MySQL, SQL server, CDB
                                  #JavaScript client: BIGINT
                                  #In schema: INT
BigInt @db.BigInt                 #Postgres: int8, also MySQL, SQL server
BigInt @db.UnsignedBigInt         #Only MySQL
BigInt @db.Int8                   #Only CDB

Float                             #Postgres: float8, MongoDB: Double, SQLite: REAL, also MySQL, SQL server, CDB
                                  #JavaScript client: NUM
                                  #In schema: NUM
Float @db.Real                    #Postgres: float4, also SQL server
Float @db.DoublePrecision         #Postgres: float8
Float @db.Float                   #Only MySQL, SQL server
Float @db.Double                  #Only MySQL
Float @db.[Small]Money            #Only SQL server
Float @db.Float4|8                #Only CDB

Decimal                           #Postgres: numeric(65, 30), SQLite: DECIMAL, also MySQL, SQL server, CDB
                                  #Not with MongoDB
                                  #JavaScript client: DECIMAL (from decimal.js library)
                                  #In schema: NUM
Decimal @db.Decimal(NUM, NUM2)    #Postgres: numeric(NUM, NUM2), also MySQL, SQL server, CDB
Decimal @db.Money                 #Postgres: money

DateTime                          #Postgres: timestamp(3), MongoDB: Timestamp, SQLite: NUMERIC|STRING, also MySQL, SQL server, CDB
                                  #JavaScript client: DATE
                                  #In schema: "YYYY-MM-DDTHH:MM:SSTZ"
DateTime @db.Timestamp(NUM)       #Postgres: timestamp(NUM), also MySQL, CDB
DateTime @db.Timestamptz(NUM)     #Postgres: timestamptz(NUM), also CDB
DateTime @db.Date                 #Postgres: date, also SQL server, CDB
DateTime @db.Time(NUM)            #Postgres: time(NUM), also MySQL, CDB
DateTime @db.Timetz(NUM)          #Postgres: timetz(NUM), also CDB
DateTime @db.Date[Time](NUM)      #Only MySQL
DateTime @db.DateTime[2]          #Only SQL server
DateTime @db.SmallDateTime        #Only SQL server
DateTime @db.DateTimeOffset       #Only SQL server
DateTime @db.Time                 #Only SQL server

Json                              #Postgres: jsonb, MongoDB: BSON v2 relaxed, also MySQL, SQL server, CDB
                                  #Not with SQLite
                                  #JavaScript client: VAL
                                  #In schema: ???
Json @db.Json                     #Postgres: json, also MySQL
Json @db.JsonB                    #Postgres: jsonb, also CDB
Json @db.NVarChar                 #Only with SQL server

Bytes                             #Postgres: bytea, MongoDB: BinData, SQLite: BLOB, also MySQL, SQL server, CDB
                                  #JavaScript client: Node.js BUFFER
                                  #In schema: "BASE64"
Bytes @db.ByteA                   #Postgres: bytea
Bytes @db.Binary                  #Only MySQL, SQL server
Bytes @db.VarBinary               #Only MySQL, SQL server
Bytes @db.Bit                     #Only MySQL
Bytes @db.[Tiny|Medium|Long]Blob  #Only MySQL
Bytes @db.Image                   #Only SQL server
Bytes @db.Bytes                   #Only CDB
Bytes @db.BinData                 #MongoDB: BinData
Bytes @db.ObjectId                #MongoDB: ObjectId

Unsupported("TYPE")               #Database type called exactly TYPE
                                  #Not with MongoDB
                                  #Implies @ignore
                                  #In schema: not possible


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:       SCHEMA ATTRIBUTE        :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


@ATTR[([ARG: ]VAL, ...)]          #Attribute. Options to FIELD
                                  #ARGs can always be named, and often also positional
@@ATTR[([ARG: ]VAL, ...)]         #Same for options to multiple FIELDs, or to MODEL|ENUM

@map(STR)                         #Database COL name
                                  #Def: "FIELD"
                                  #Meant when:
                                  #  - "FIELD" contains invalid characters
                                  #  - want a different name in API than in database
@@map(STR)                        #Same but for database MODEL name

@ignore                           #Omit FIELD in JavaScript client, except in raw queries
                                  #If no @default, cannot create|update|upsert MODEL
                                  #But works with prisma db|migrate
                                  #Done at the ORM-level, i.e. on any database
@@ignore                          #Same but for a MODEL

@@schema("SCHEMA")                #MODEL's database "SCHEMA" (def: default database "SCHEMA")
                                  #"SCHEMA" is database concept, not Prisma concept with the same name
                                  #Only with Posgres, SQL server, CDB
                                  #Requires PREVIEW "multiSchema"
datasource.schemas                #Database "SCHEMA"_ARR available to @@schema


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:        SCHEMA DEFAULT         :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


@updatedAt                        #Set on each MODEL update (unless overridden) with current time
                                  #DateTime FTYPE
                                  #Done at ORM-level, i.e. for any database

@default(OPTS[.value])            #FIELD's default VAL
                                  #For any database
                                  #If none, FIELD is required
OPTS.map                          #STR. Only for SQL server
OPTS.value                        #Default VAL
                                  #Can also use any of the following

now()                             #DateTime FTYPE
                                  #With most databases: current_timestamp
                                  #MongoDB: done at ORM-level

uuid()                            #String FTYPE
                                  #Done at ORM-level, i.e. for any database
                                  #UUIDv4
cuid()                            #String FTYPE
                                  #Done at ORM-level, i.e. for any database
                                  #CUID1 (min 30 chars)

autoincrement()                   #Postgres: serial2|4|8, SQLite: AUTOINCREMENT, also with MySQL, SQL server, CDB
                                  #Int FTYPE
                                  #  - Postgres: Int @db.[Small|Big]Int
                                  #Not with MongoDB

dbgenerated('EXPR')               #Database-specific EXPR, e.g. FUNC(), OPs, etc.
                                  #Not with MongoDB

auto()                            #ObjectId
                                  #String @db.ObjectId FTYPE
                                  #Must use @map("_id")
                                  #Only with MongoDB

sequence(...)                     #SEQUENCE table
                                  #Only with CDB


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:         SCHEMA INDEX          :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


@id[(OPTS)]                       #Primary key constraint on one FIELD
                                  #Only one per MODEL
                                  #Required for each MODEL
                                  #  - alternative: one @[@]unique, if required and not MongoDB
                                  #For any database
                                  #MongoDB:
                                  #  - required
                                  #  - must use @map("_id")
                                  #  - if ObjectId, must use:
                                  #     - String|Bytes @db.ObjectId
                                  #     - optional: @default(auto())
                                  #Cannot be on optional FIELD
OPTS.map|length|clustered         #Like @@index
OPTS.sort                         #Like @@index
                                  #Only with SQL server

@@id(OPTS)                        #Like @id, but on multiple FIELDs
                                  #Not with MongoDB
OPTS.sort|map|length|clustered    #Like @id
OPTS.fields|name                  #Like @@index

@unique[(OPTS)]                   #Unique constraint on one FIELD
                                  #For any database
                                  #nulls are distinct
OPTS.sort|map|length|clustered    #Like @@index

@@unique(OPTS[.fields])           #Like @unique, but on multiple FIELDs
                                  #With MongoDB: index must be created manually
OPTS.sort|map|length|clustered    #Like @unique
OPTS.fields|name                  #Like @@index

@@fulltext(OPTS.fields)           #Text search index
                                  #Only with MySQL, MongoDB
                                  #Requires PREVIEW fullTextIndex

@@index(OPTS[.fields])            #Database index
OPTS.fields                       #ARR of FIELD_VARR[(OPTS)]
                                  #None must not be optional
OPTS.name                         #Dynamic 'FIELD' created with combination of all fields, i.e. can be queried
                                  #Def: 'FIELD_FIELD2_...'
OPTS.sort                         #ENUM. Asc (def) or Desc
OPTS.map                          #Database 'INDEX' name
                                  #Database INDEX can already exist
                                  #Def:
                                  #  - if database INDEX already exist: re-use its name
                                  #  - @[@]id: "TABLE_pkey"
                                  #  - @[@]unique: "TABLE_FIELD..._unique"
                                  #  - @[@]index: "TABLE_FIELD..._index"
                                  #  - @relation: "TABLE_FIELD..._fkey"
                                  #Not with MySQL, MongoDB
OPTS.type                         #ENUM. ACCESS_METHOD
                                  #Can be BTree (def), Gist, Gin, SpGist, Brin, Hash
                                  #Only with Postgres
OPTS.ops                          #ENUM. OPCLASS
                                  #Can be raw("OPCLASS") if value not available in ENUM
                                  #Only with Postgres
OPTS.length                       #NUM. Only with MySQL
OPTS.clustered                    #BOOL. Only with SQL server


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:       SCHEMA RELATIONS        :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


@relation(OPTS)                   #Foreign key source|destination constraint on FIELDs
                                  #MODEL FTYPE:
                                  #  - must be on populated FIELD, not present in database
                                  #  - alongside separate key FIELD, present in database
                                  #Cannot use @unique (but can use @@unique) nor @default
                                  #For all databases
OPTS.name                         #"RELATION"
                                  #Used as database TABLE name, if implicit n-n relationship
OPTS.map                          #Like @@index
OPTS.fields                       #FIELD_VARR_ARR of source foreign keys
                                  #Source FIELDs:
                                  #  - can be ARRs, for 1|n-n relationships
                                  #  - if not @unique, are 1|n-n relationship, not 1-1
OPTS.references                   #FIELD_VARR_ARR of destination primary keys
                                  #Destination FIELDs can be ARRs, for 1|n-n relationships
OPTS.onUpdate|onDelete            #ENUM among NoAction (def), Cascade, Restrict, SetNull, SetDefault
                                  #Like SQL `references ... on update|delete ACTION`

REVERSE RELATION ==>              #If 1-1 relationship, destination TABLE can have a FIELD with the source MODEL as FTYPE
                                  #It is populated, even without any @relation nor key FIELD
                                  #It must be optional `FTYPE?`
IMPLICIT N-N RELATION ==>         #If source|destination TABLEs both refer to each other with a FIELD with the other MODEL as FTYPE[]
                                  #Then, a n-n TABLE is handled at ORM-level, without any @relation nor key FIELD needed
                                  #Can still define @relation to change OPTS.name
                                  #  - cannot use other OPTS.*

datasource.relationMode           #ENUM. Whether @relation:
                                  #  - "foreignKeys":
                                  #     - creates a database foreign key
                                  #     - default with most databases
                                  #     - usually recommended
                                  #  - "prisma":
                                  #     - emulates foreign key at the ORM layer
                                  #     - required for "mongodb"


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:           GENERATE            :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


schema generate                   #Call all GENERATOR_PROVIDERs
--watch                           #Call on SCHEMA file change

prisma db push
prisma migrate dev|reset
--skip-generate                   #Unless set, calls `prisma generate` at the end

GENERATOR_PROVIDER                #Module generating code base on SCHEMA. Can be:
                                  #  - "prisma-client-js": Node.js client
                                  #  - "MODULE|PATH": third-party

generator GENERATOR {
  VAR = VAL
  ...
}                                 #GENERATORs used by `schema generate`, in SCHEMA

generator.provider
schema generate --generator       #"GENERATOR_PROVIDER"

generator.output                  #"PATH". Def: "./node_modules/.prisma/client"


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:          INTROSPECT           :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


prisma db pull                    #"Introspection". Make SCHEMA reflect production DATABASE
--print                           #Print new SCHEMA to stdout instead of modifying it

SCAFFOLD ==>                      #Can be used to scaffold initial SCHEMA

INCREMENTAL CHANGES ==>           #Can also be used as alternative to `prisma db push` and `prisma migrate`
                                  #I.e. modify production DATABASE -> SCHEMA, instead of opposite
                                  #Not with MongoDB
--force                           #Overwrite everything on incremental changes
                                  #Unless specified, do not overwrite:
                                  #  - comments
                                  #  - order of {...} blocks
                                  #     - but order of FIELDs within blocks is always same as database COLs order,
                                  #       with complex FTYPEs before simple ones
                                  #  - @[@]map
                                  #  - @updatedAt
                                  #  - @default(uuid|cuid())
                                  #  - @relation(name: "RELATION")
                                  #  - @[@]ignore

SUBSET ==>                        #To only introspect a subset of production DATABASE, can:
                                  #  - use datasource.schemas
                                  #  - use a datasource.url with a database USER with permissions only to read specific entities
                                  #Alternative is also to introspect some entities, but use @[@]ignore on them

MONGODB ==>                       #Schemaless, i.e. use sampled data instead
                                  #Cannot infer @[@]ATTR nor FTYPE? FTYPE[]
                                  #Can only infer @@index if INDEX has some data

NAMES ==>                         #Invalid characters in MODEL|FIELD|etc. are replaced with _
                                  #@[@]map is then also used

POSTGRES EXTENSIONS ==>           #Only infers specific ones: citext, pgcrypto, uuid-ossp, postgis


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:             PUSH              :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


prisma db push                    #Inverse of `prisma db pull`
                                  #Make production DATABASE reflect SCHEMA, using direct database DDL
                                  #Meant for the initial scaffolding, or for local prototyping
                                  #Only add|modify entities, not remove
                                  #Does not create VIEWs
--force-reset                     #Empty database first
--accept-data-loss                #Unless set, fails if TABLE DDL change requires truncating its data


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:            MIGRATE            :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


prisma migrate ...                #Make production DATABASE reflect SCHEMA, using automatically generated SQL files
                                  #Meant for incremental changes

MONGODB ==>                       #Does not support `prisma migrate`
                                  #  - except `prisma migrate diff`, without --from|to-migrations nor --script
                                  #Must use `prisma db push|execute` instead

datasource.shadowDatabaseUrl      #Connection "URL" to the "shadow database"
prisma migrate diff               #Temporary and used only by `prisma migrate dev` and `prisma migrate diff --from|to-migrations`
--shadow-database-url             #As opposed to the "dev database", which is the main local database

./prisma/migrations               #MDIR
MDIR/MIGRATION/migration.sql      #SQL file with DDL commands, indicating incremental changes of SCHEMA
                                  #"MIGRATION" is "YYYYMMDDHHSSMM_MNAME"
MDIR/migration_lock.toml          #File with metadata, e.g. DB_PROVIDER

_prisma_migrations                #TABLE recording all applied MIGRATIONs in dev|production database
                                  #Includes applied MIGRATIONs:
                                  #  - list: to detect additions|removals
                                  #  - checksums: to detect changes

LOCAL VS PRODUCTION ==>           #prisma migrate dev|reset|db seed|diff: local development
                                  #prisma migrate deploy|resolve|status: production|CI

prisma migrate dev                #Create migration file by comparing:
                                  #  - current SCHEMA
                                  #  - all previously applied migrations (_prisma_migrations)
                                  #     - by creating a temporary "shadow database" and applying all migrations to it
                                  #If dev database has drifted from previous migrations, first call `prisma migrate reset`
--name                            #"MNAME"
--create-only                     #When not set, also apply new migration file to dev database
                                  #When set, can manually modify it first

prisma migrate reset              #Re-create dev database, then apply all migrations to it
--force                           #No confirmation prompt

package.json prisma.seed          #"SEED_COMMAND". Shell command meant to populate dev database with data
                                  #Recommended location: ./prisma/seed.ts
prisma db seed [-- ARGS...]       #Calls "SEED_COMMAND ARGS..."
prisma migrate dev|reset
--skip-seed                       #Unless set, calls `prisma db seed` at the end of `prisma migrate reset`

prisma migrate deploy             #Applies new migrations to production database

prisma migrate resolve            #Fix a failed migration by changing its status in _prisma_migrations TABLE
--applied                         #"MIGRATION". Mark failed migration as successful, i.e. not retried
--rolled-back                     #"MIGRATION". Mark failed migration to retry

prisma migrate status             #Print information about migrations for the production database:
                                  #  - count
                                  #  - whether new migrations exist
                                  #Exit code 0 if no issues nor new migrations

prisma migrate diff               #Compare 2 databases|SCHEMAs, printing result on stdout
                                  #Must have same "DB_PROVIDER"
--script                          #Print migration SQL instead
--exit-code                       #Exit code 2 if there is a diff
                                  #With|without it: exit code 1 if error
--from|to-*                       #Must use one for each
--from|to-url                     #Database connection "URL", as is
--from|to-schema-datasource       #Database connection "URL", using "PATH" to SCHEMA, then using datasource.url
--from|to-schema-datamodel        #"PATH" to SCHEMA
--from|to-migrations              #"DIR" to MIGRATION files
--from|to-empty                   #Empty database

ENVVAR PRISMA_SCHEMA_             #Unless set, use database advisory lock to prevent running 2 concurrent `prisma migrate` against same production database
 DISABLE_ADVISORY_LOCK            #Always 10 seconds timeout

ENVVAR HTTP[S]_PROXY|NO_PROXY     #Can be used


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:            EXECUTE            :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


prisma db execute                 #Run SQL against database
                                  #Output only meant for debugging or success reporting, not returning data
                                  #Not with MongoDB
--file                            #'PATH' to SQL file
--stdin                           #SQL as stdin instead
--url                             #Def: datasource.url


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:            STUDIO             :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


PRISMA STUDIO ==>                 #Web app to create|edit|delete and view|filter|sort database
                                  #Only the data modelled with SCHEMA

prisma studio                     #Start local server, then open studio web app
--port|-p                         #NUM (def: 5555)
--browser|-b
ENVVAR BROWSER                    #'COMMAND' (def: default browser)


                                             /=+===============================+=\
                                            /  :                               :  \
                                            )==:          CLIENT MAIN          :==(
                                            \  :_______________________________:  /
                                             \=+===============================+=/


@prisma/client                    #Node.js client
ENVVAR
 PRISMA_GENERATE_SKIP_AUTOINSTALL #Unless set, `prisma generate` installs @prisma/client, if 'prisma-client-js' GENERATOR_PROVIDER
ENVVAR
 PRISMA_SKIP_POSTINSTALL_GENERATE #UNless set, @prisma/client has a `postinstall` script that calls `prisma generate`

new PrismaClient([POPTS])         #CLIENT

POPTS.log                         #'LEVEL'_ARR|PLOG_OPT_ARR
PLOG_OPT.level                    #'LEVEL' among:
                                  #  - 'error'
                                  #  - 'warn' (def)
                                  #  - 'info'
                                  #  - 'query': debug, including all SQL queries
PLOG_OPT.emit                     #STR among:
                                  #  - 'stdout' (def): print to stdout
                                  #  - 'event': emit events with CLIENT.$on(FUNC(LOG|QUERY_EVENT))
LOG|QUERY_EVENT.timestamp         #DATE
LOG|QUERY_EVENT.target            #STR
LOG_EVENT.message                 #STR. Log message
QUERY_EVENT.query                 #STR. SQL query
QUERY_EVENT.params                #STR. SQL query parameters
QUERY_EVENT.duration              #NUM (in ms) from client sending to receiving

POPTS.errorFormat                 #Log format with PLOG_OPT.level 'error' and PLOG_OPT.emit 'stdout'
                                  #STR among:
                                  #  - 'pretty'
                                  #  - 'colorless' (def): pretty but no colors
                                  #  - 'minimal'

ENVVAR DEBUG=prisma:client        #Debug logs
ENVVAR NO_COLOR                   #

CLIENT.MODEL                      #CMODEL
                                  #MODEL is lowercase'd
                                  #Fully typed according to SCHEMA, except nested|populated models
COBJ                              #MODEL as an OBJ
BATCH.count                       #NUM of COBJs created|updated|deleted

CMODEL.findUnique[OrThrow](OPTS)->>COBJ|null
                                  #If model not found:
                                  #  - if `OrThrow`: throw NotFoundError
                                  #  - otherwise: returns null

CMODEL.findFirst[OrThrow]([OPTS])->>COBJ|null
                                  #If model not found: like findUnique[OrThrow]()

CMODEL.findMany([OPTS])->>COBJ_ARR

CMODEL.count([OPTS])->>NUM

CMODEL.aggregate(OPTS)->>OBJ

CMODEL.groupBy(OPTS)->>ARR

CMODEL.create(OPTS)->>COBJ

CMODEL.createMany(OPTS)->>BATCH

CMODEL.update(OPTS)->>COBJ
                                  #Throw NotFoundError if not found

CMODEL.updateMany(OPTS)->>BATCH

CMODEL.upsert(OPTS)->>COBJ

CMODEL.delete(OPTS)->>COBJ
                                  #Throw NotFoundError if not found

CMODEL.deleteMany([OPTS])->>BATCH

OPTS.where
                                  #With CMODEL.findFirst()
                                  #Also with CMODEL.findUnique(): but only on @unique|@id fields

$transaction: see whole page for references to it???
